<section class="test-results" *ngIf="testResults$ | async as testResults">
  <app-progress-bar
    [isFirstNotification]="isFirstNotification"
    [scrollContainer]="containerElement"
  ></app-progress-bar>
  <section class="results-container" @fadeIn>
    <div class="results-content">
      <h2 class="title-mob title-primary">
        {{ testResults.title }} @if (TEST_NAME()===mainTestNames.BeYourself) {
        ({{ testResults.type }}
        ) }
      </h2>

      @if(TEST_NAME()===mainTestNames.YouCoffee && testResults.subCategoryName){
      <div class="you-coffee-container">
        <div
          class="pointing-subtype-img"
          [style.top]="
            getPositionElementBySubType(testResults.subCategoryName) + '%'
          "
        >
          ☕
        </div>
        <img [src]="getImgUrl(testResults.type)" alt="" class="results-image" />
      </div>

      }@else{
      <img [src]="getImgUrl(testResults.type)" alt="" class="results-image" />

      }

      <div class="results-text-container">
        <h2 class="title-primary">
          {{ testResults.title }}
          @if (TEST_NAME()===mainTestNames.BeYourself) {
          <br />
          ({{ testResults.type }} ) }
        </h2>

        @if (testResults.subCategoryName) {

        <h3 class="coffee-subCategory subtitle">
          Твій рівень розкритості: {{ testResults.subCategoryName }}
        </h3>

        }
        <p class="subtitle" appPrettyText>
          {{ testResults.subtitle }}
        </p>
      </div>
    </div>
    <ul class="results-text-list">
      @for (item of testResults.sections; track $index) {

      <li class="results-text-card">
        <h3 class="subtitle">
          {{ item.sectionsName }}
        </h3>
        <p class="subtitle" appPrettyText>
          {{ item.sectionsDescription }}
        </p>

        <ul>
          @for (sectionItem of item.sectionsList; track $index) {

          <li>
            <p class="subtitle" appPrettyText>
              {{ sectionItem }}
            </p>
          </li>
          }
        </ul>
      </li>
      }
    </ul>
    <br />
    <div class="rating-wrapper">
      <ng-lottie
        [options]="options"
        [styles]="{ width: '250px', height: '250px' }"
      ></ng-lottie>
      <!-- <h3 class="shared-title subtitle">Поділись результатами</h3>
    <br />
    <share-buttons
      [title]="testResults.title"
      [description]="testResults.subtitle"
      [include]="includeShareBtn"
      [showText]="true"
      [url]="fullUrl"
    ></share-buttons> -->
      <br />

      <app-star-rating [testName]="TEST_NAME()"></app-star-rating>
    </div>
  </section>

  <div #scrollContainer></div>
  @defer (on viewport; ) {
  <div [appResizeOnVisible]="2" [visibleCards]="visibleCards">
    <app-consultations-cards [sliderKey]="consultationsSliderKey">
    </app-consultations-cards>
  </div>
  }@placeholder {
  <div style="height: 350px"></div>
  }
  <br />
</section>

<div [appResizeOnVisible]="3" [visibleCards]="visibleCards">
  <app-hero-cards-slider
    [hiddenTestName]="TEST_NAME()"
    [sliderKey]="cardsSliderKey"
  ></app-hero-cards-slider>
</div>
